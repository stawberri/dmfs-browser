(function(){var e,t=[].slice,n=[].join;window.Buffer=buffer.Buffer,e=$("body"),$("#text-to-file").click(function(e){function t(e){return new Buffer(e,"base64")}function n(e){return new Uint8Array(e)}var r,c,f,o,i,l,a,u,s,d,p,v,w,B,b,h,g,y,k;for(e.preventDefault(),r=$("#compressed-text").val(),c=[],f=/!!DMFS(\{(?:(?!!!DMFS)[\s\S])*\})/g;o=f.exec(r);)c.push(o[1]);for(i={},l=0,a=c.length;a>l;++l){u=c[l];try{if(s=$.parseJSON(u),null==s.fn||null==s.ct)continue;null==s.pt&&(s.pt=0),(i[d=s.fn]||(i[d]=[]))[s.pt]=s.ct}catch(S){return void(p=S)}}e:for(v in i){for(w=i[v],s={fn:v,ct:""},l=0,a=w.length;a>l;++l){if(B=w[l],null==B)continue e;s.ct=B+s.ct}""!==s.ct&&(b=s.fn,h=s.ct,h=Base65536.decode(h),$("#use-base64").is(":checked")&&(h=h.toString(),h=t(h)),h=n(h),g=new Blob([h],{type:"application/octet-stream"}),y=URL.createObjectURL(g),k=$("<a>"),k.attr({href:y,download:b}),k[0].click())}}),$("#file-to-text").click(function(e){var r;return e.preventDefault(),r=$("#file-picker")[0].files,r.length?($("#compressed-text").val("Processing~"),$.when.apply($,function(){function e(e){var t,n;return t=$.Deferred(),n=new FileReader,n.addEventListener("loadend",function(){var r,c;return r=new Buffer(new Uint8Array(n.result)),$("#use-base64").is(":checked")&&(r=r.toString("base64"),r=function(e){return new Buffer(e)}(r)),r=Base65536.encode(r),c={fn:e.name,pt:0,ct:r},c=JSON.stringify(c),t.resolve("!!DMFS"+c)}),n.readAsArrayBuffer(e),t}var t,n,c,f=[];for(t=0,c=(n=r).length;c>t;++t)f.push(e.call(this,n[t]));return f}.call(this)).done(function(){var e;return e=t.call(arguments),$("#compressed-text").val(n.call(e,"\n"))})):void 0})}).call(this);
